version: '3.8'

services:
  researcharr:
    image: ghcr.io/wikid82/researcharr:latest
    container_name: researcharr
    restart: unless-stopped
    ports:
      - "2929:2929" # Expose web UI on port 2929
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/New_York
      - WEBUI_PORT=2929
      - LOGLEVEL=INFO
    volumes:
      # Persist runtime configuration and DB to host for inspection/troubleshooting
      - ${HOST_CONFIG_PATH:-./config}:/config:rw
      # Persist logs written under /config/logs (cron, scheduler, etc.)
      - ${HOST_LOGS_PATH:-./logs}:/config/logs:rw
    logging:
      driver: json-file
      options:
        max-size: "50m"
        max-file: "5"
    healthcheck:
      test: ["CMD-SHELL", "curl -fsS http://localhost:2929/health || exit 1"]
      interval: 30s
      timeout: 5s
      retries: 3
