<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="researcharr contributors" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Sonarr Search Scope Implementation - researcharr</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/css/researcharr.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Sonarr Search Scope Implementation";
        var mkdocs_page_input_path = "Sonarr-Search-Scopes.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> researcharr
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">researcharr documentation — Day One</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../API/">ResearchArr API (v1)</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../CI-and-Development/">CI and Development</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Changelog/">Changelog</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Contributing/">Contributing to researcharr</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Coverage-Gutters-Example-Comparison/">Coverage Gutters Example Structure</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Coverage-Gutters-Quick-Reference/">Coverage Gutters - Quick Reference Card</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Coverage-Gutters-Quick-Start/">Coverage Gutters - Visual Quick Start Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Coverage-Gutters-Setup/">Coverage Gutters Setup</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../DEV/">DEV</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Deployment-and-Resources/">Deployment and Resource Recommendations</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Environment-Variables/">Environment variables</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../FAQ/">FAQ</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Getting-Started/">Getting Started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Health-and-Metrics/">Health and Metrics Endpoints</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Integrations/">Integrations</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Logs/">Logs and Live Streaming</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Packaging-and-Distribution/">Packaging and Distribution</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Plugins/">Plugins and instance configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Recent-Changes/">Recent Changes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Renovate-Configuration/">Renovate Bot Configuration Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Roadmap/">Roadmap</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Sonarr Search Scope Implementation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#intelligent-scope-selection-logic">Intelligent Scope Selection Logic</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#automatic-adjustment-based-on-airing-status">Automatic Adjustment Based on Airing Status</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#search-scope-options">Search Scope Options</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1-season-search-default-for-old-content">1. SEASON Search (Default for Old Content)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-episode-search-auto-selected-for-new-content">2. EPISODE Search (Auto-Selected for New Content)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3-series-search">3. SERIES Search</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#implementation-details">Implementation Details</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#enhanced-auto-scope-determination">Enhanced Auto-Scope Determination</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#air-date-detection">Air Date Detection</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#episode-level-search-for-airing-seasons">Episode-Level Search for Airing Seasons</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#api-efficiency-with-intelligence">API Efficiency with Intelligence</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#optimized-patterns">Optimized Patterns</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#indexer-impact-comparison">Indexer Impact Comparison</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configuration-options">Configuration Options</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#searchrequest-parameters">SearchRequest Parameters</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#helper-method-examples">Helper Method Examples</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#intelligence-benefits">Intelligence Benefits</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#for-currently-airing-content">For Currently Airing Content</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#for-completed-content">For Completed Content</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#transition-period-management">Transition Period Management</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#testing-coverage">Testing Coverage</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#migration-notes">Migration Notes</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#automatic-upgrade">Automatic Upgrade</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#performance-impact">Performance Impact</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Status-and-Warnings/">System status warnings and how to fix them</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Versioning/">Versioning &amp; Releases</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">researcharr</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Sonarr Search Scope Implementation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="sonarr-search-scope-implementation">Sonarr Search Scope Implementation</h1>
<h2 id="overview">Overview</h2>
<p>The Sonarr integration now supports intelligent search scope selection that automatically adjusts based on episode air dates and airing status. This ensures optimal indexer usage while maximizing search effectiveness for both currently airing and completed seasons.</p>
<h2 id="intelligent-scope-selection-logic">Intelligent Scope Selection Logic</h2>
<h3 id="automatic-adjustment-based-on-airing-status">Automatic Adjustment Based on Airing Status</h3>
<p>The system now intelligently determines the optimal search scope:</p>
<ol>
<li><strong>Currently Airing Seasons</strong> → Episode-level search</li>
<li>Better indexer coverage as releases are frequent</li>
<li>Searches only for aired episodes (not future episodes)</li>
<li>
<p>More accurate for ongoing content</p>
</li>
<li>
<p><strong>Recently Finished Seasons</strong> (&lt; 1 week) → Episode-level search</p>
</li>
<li>Indexers still updating with new releases</li>
<li>Better catch rate during the "honeymoon period"</li>
<li>
<p>Allows indexers to fully populate</p>
</li>
<li>
<p><strong>Completed Seasons</strong> (&gt; 1 week) → Season-level search</p>
</li>
<li>Efficient bulk search for stable content</li>
<li>Reduced indexer API usage</li>
<li>Optimal for archived content</li>
</ol>
<h2 id="search-scope-options">Search Scope Options</h2>
<h3 id="1-season-search-default-for-old-content">1. SEASON Search (Default for Old Content)</h3>
<ul>
<li><strong>Scope</strong>: <code>SonarrSearchScope.SEASON</code></li>
<li><strong>Auto-Used When</strong>: Season finished airing &gt; 1 week ago</li>
<li><strong>Indexer Impact</strong>: Low - Single API call per season</li>
<li><strong>Use Case</strong>: Efficient for completed seasons</li>
<li><strong>Example</strong>: Search for all missing episodes in a finished season</li>
</ul>
<h3 id="2-episode-search-auto-selected-for-new-content">2. EPISODE Search (Auto-Selected for New Content)</h3>
<ul>
<li><strong>Scope</strong>: <code>SonarrSearchScope.EPISODE</code></li>
<li><strong>Auto-Used When</strong>: Season currently airing OR finished &lt; 1 week ago</li>
<li><strong>Indexer Impact</strong>: Higher but more effective for new content</li>
<li><strong>Use Case</strong>: Current/recent content with active releases</li>
<li><strong>Example</strong>: Search aired episodes in currently airing season</li>
</ul>
<h3 id="3-series-search">3. SERIES Search</h3>
<ul>
<li><strong>Scope</strong>: <code>SonarrSearchScope.SERIES</code></li>
<li><strong>Auto-Used When</strong>: No season specified</li>
<li><strong>Indexer Impact</strong>: Very High - Potentially many API calls</li>
<li><strong>Use Case</strong>: Initial series setup or major catch-up</li>
<li><strong>Example</strong>: Search for all missing episodes across all seasons</li>
</ul>
<h2 id="implementation-details">Implementation Details</h2>
<h3 id="enhanced-auto-scope-determination">Enhanced Auto-Scope Determination</h3>
<pre><code class="language-python"># Smart scope adjustment (default behavior)
request = SonarrClient.create_search_request(
    &quot;search-123&quot;, &quot;Breaking Bad&quot;, tvdb_id=81189, season=2
    # auto_adjust_scope=True by default
)
# Will automatically:
# - Use EPISODE scope if season is currently airing
# - Use EPISODE scope if season finished &lt; 1 week ago
# - Use SEASON scope if season finished &gt; 1 week ago

# Disable intelligent adjustment
request = SonarrClient.create_search_request(
    &quot;search-124&quot;, &quot;Breaking Bad&quot;, tvdb_id=81189, season=2,
    search_scope=SonarrSearchScope.SEASON,
    auto_adjust_scope=False  # Force season scope regardless of airing status
)
</code></pre>
<h3 id="air-date-detection">Air Date Detection</h3>
<p>The system analyzes episode air dates from Sonarr to determine:
- <strong>Currently Airing</strong>: Not all episodes have aired yet
- <strong>Recently Finished</strong>: All episodes aired, but within 1 week
- <strong>Completed</strong>: All episodes aired &gt; 1 week ago</p>
<h3 id="episode-level-search-for-airing-seasons">Episode-Level Search for Airing Seasons</h3>
<p>When a season is still airing, episode searches target only aired episodes:
- Excludes future episodes (not yet available)
- Searches only missing episodes (episodes without files)
- Reduces unnecessary indexer requests</p>
<h2 id="api-efficiency-with-intelligence">API Efficiency with Intelligence</h2>
<h3 id="optimized-patterns">Optimized Patterns</h3>
<ol>
<li><strong>New Episodes</strong>: Immediate episode-level search for best indexer coverage</li>
<li><strong>Season Finale</strong>: Episode-level search for 1 week post-finale</li>
<li><strong>Archive Content</strong>: Efficient season-level search for bulk operations</li>
</ol>
<h3 id="indexer-impact-comparison">Indexer Impact Comparison</h3>
<ul>
<li><strong>Traditional Season Search</strong>: 1 API call, may miss recent releases</li>
<li><strong>Intelligent Episode Search</strong>: N API calls for aired episodes, better coverage</li>
<li><strong>Smart Transition</strong>: Automatically switches to season search when optimal</li>
</ul>
<h2 id="configuration-options">Configuration Options</h2>
<h3 id="searchrequest-parameters">SearchRequest Parameters</h3>
<pre><code class="language-python"># TV-specific parameters
season: Optional[int] = None
episode: Optional[int] = None

# Air date information (automatically populated from Sonarr)
air_date: Optional[datetime] = None
season_end_date: Optional[datetime] = None

# Intelligence configuration
search_scope: SonarrSearchScope = SonarrSearchScope.SEASON
auto_adjust_scope: bool = True  # Enable intelligent adjustment
</code></pre>
<h3 id="helper-method-examples">Helper Method Examples</h3>
<pre><code class="language-python"># Intelligent season search (recommended)
request = SonarrClient.create_search_request(
    &quot;search-123&quot;, &quot;The Mandalorian&quot;, tvdb_id=361753, season=3
)
# Auto-adjusts based on airing status

# Force specific scope
request = SonarrClient.create_search_request(
    &quot;search-124&quot;, &quot;Breaking Bad&quot;, tvdb_id=81189, season=2,
    search_scope=SonarrSearchScope.SEASON,
    auto_adjust_scope=False
)

# Specific episode (always uses episode scope)
request = SonarrClient.create_search_request(
    &quot;search-125&quot;, &quot;The Mandalorian&quot;, tvdb_id=361753,
    season=3, episode=7
)
</code></pre>
<h2 id="intelligence-benefits">Intelligence Benefits</h2>
<h3 id="for-currently-airing-content">For Currently Airing Content</h3>
<ul>
<li>✅ Better indexer coverage during active release periods</li>
<li>✅ Excludes unaired episodes (no wasted API calls)</li>
<li>✅ Adapts to release schedules automatically</li>
</ul>
<h3 id="for-completed-content">For Completed Content</h3>
<ul>
<li>✅ Efficient bulk operations for archived seasons</li>
<li>✅ Reduced indexer load for stable content</li>
<li>✅ Optimal for batch operations</li>
</ul>
<h3 id="transition-period-management">Transition Period Management</h3>
<ul>
<li>✅ 1-week buffer period after season finale</li>
<li>✅ Allows indexers to fully populate</li>
<li>✅ Smooth transition to efficient bulk search</li>
</ul>
<h2 id="testing-coverage">Testing Coverage</h2>
<ul>
<li>✅ Intelligent scope adjustment for currently airing seasons</li>
<li>✅ Intelligent scope adjustment for recently finished seasons</li>
<li>✅ Season scope retention for old completed seasons</li>
<li>✅ Disable intelligent adjustment functionality</li>
<li>✅ Air date parsing and status determination</li>
<li>✅ Episode search for aired episodes only</li>
<li>✅ Helper method with intelligence parameters</li>
<li>✅ Backward compatibility</li>
</ul>
<h2 id="migration-notes">Migration Notes</h2>
<h3 id="automatic-upgrade">Automatic Upgrade</h3>
<ul>
<li>Existing code works unchanged</li>
<li>Intelligence enabled by default (<code>auto_adjust_scope=True</code>)</li>
<li>Season scope remains the base default</li>
<li>No breaking changes to existing APIs</li>
</ul>
<h3 id="performance-impact">Performance Impact</h3>
<ul>
<li><strong>Improved</strong>: Better success rates for new content</li>
<li><strong>Optimized</strong>: Automatic transition to efficient search for old content</li>
<li><strong>Reduced</strong>: Overall indexer load through intelligent timing</li>
</ul>
<p>This intelligent implementation addresses the dynamic nature of TV content release cycles while maintaining optimal indexer efficiency across different content lifecycle stages.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Roadmap/" class="btn btn-neutral float-left" title="Roadmap"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Status-and-Warnings/" class="btn btn-neutral float-right" title="System status warnings and how to fix them">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="None" class="fa fa-code-fork" style="color: #fcfcfc"> Wikid82/researcharr</a>
        </span>
    
    
      <span><a href="../Roadmap/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Status-and-Warnings/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
